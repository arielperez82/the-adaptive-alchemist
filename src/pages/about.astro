---
import { Image } from 'astro:assets'

import profile from '@/assets/profile.jpg'
import BaseLayout from '@/layouts/BaseLayout.astro'
---

<BaseLayout
  title="About Me"
  description="I build high-performing, adaptive product and engineering organizations that deliver exceptional value at high velocity. With 20+ years across startups, scale-ups, and Fortune 50s, I've learned that the conventional wisdom about leadership, teams, and organizations is often spectacularly wrong."
>
  <div
    class="theme-transition-all mx-auto max-w-4xl px-4 py-8 sm:px-6 sm:py-12 md:py-16"
  >
    <div class="relative mb-12 sm:mb-16 md:mb-20">
      <div
        class="theme-transition-bg absolute -left-10 -top-10 h-36 w-36 animate-blob rounded-full bg-zinc-100 opacity-30 blur-3xl dark:bg-zinc-800/30 sm:-left-20 sm:-top-20 sm:h-48 sm:w-48 md:h-72 md:w-72"
      >
      </div>
      <div
        class="animation-delay-2000 theme-transition-bg absolute -bottom-10 -right-10 h-36 w-36 animate-blob rounded-full bg-zinc-200 opacity-30 blur-3xl dark:bg-zinc-800/30 sm:-bottom-20 sm:-right-20 sm:h-48 sm:w-48 md:h-72 md:w-72"
      >
      </div>

      <div
        class="relative grid grid-cols-1 items-center gap-8 md:grid-cols-2 md:gap-12"
      >
        <div class="order-2 text-center md:order-1 md:text-left">
          <h1
            class="theme-transition-color mb-4 text-3xl font-bold tracking-tight text-zinc-900 dark:text-zinc-100 sm:mb-6 sm:text-4xl md:text-5xl"
          >
            Hello, I'm <span
              class="theme-transition-all bg-gradient-to-r from-zinc-500 to-zinc-900 bg-clip-text text-transparent dark:from-zinc-300 dark:to-zinc-100"
            >
              Ariel PÃ©rez
            </span>
          </h1>

          <p
            class="theme-transition-color mb-6 text-lg leading-relaxed text-zinc-600 dark:text-zinc-400 sm:mb-8 sm:text-xl"
          >
            Engineer. Product leader. Entrepreneur. Systems thinker.
          </p>

          <div
            class="social-links-container theme-transition-children flex flex-wrap justify-center gap-4 md:justify-start"
          >
          </div>
        </div>

        <div class="relative order-1 md:order-2">
          <div
            class="theme-transition-all mx-auto aspect-square w-full max-w-[280px] overflow-hidden rounded-3xl border-4 border-white shadow-xl dark:border-zinc-800 sm:max-w-[320px] sm:border-8 sm:shadow-2xl md:max-w-md"
          >
            <Image
              src={profile}
              alt="Ariel PÃ©rez profile photo"
              class="h-full w-full object-cover"
              loading="eager"
            />
          </div>

          <div
            class="theme-transition-all absolute -bottom-4 -right-4 flex h-16 w-16 items-center justify-center rounded-full border-2 border-white bg-zinc-100 shadow-lg dark:border-zinc-900 dark:bg-zinc-800 sm:-bottom-6 sm:-right-6 sm:h-20 sm:w-20 sm:border-4 md:h-24 md:w-24"
          >
            <span class="text-2xl sm:text-3xl">ðŸ‘‹</span>
          </div>
        </div>
      </div>
    </div>

    <div class="theme-transition-all mb-16 sm:mb-20 md:mb-24">
      <div class="mx-auto max-w-4xl">
        <h2
          class="theme-transition-color mb-6 flex items-center justify-center text-2xl font-bold text-zinc-900 dark:text-zinc-100 sm:mb-8 sm:text-3xl md:justify-center"
        >
          <span
            class="theme-transition-bg mr-4 hidden h-1 w-8 bg-zinc-300 dark:bg-zinc-700 sm:inline-block sm:w-12"
          >
          </span>
          About Me
          <span
            class="theme-transition-bg ml-4 hidden h-1 w-8 bg-zinc-300 dark:bg-zinc-700 sm:inline-block sm:w-12"
          >
          </span>
        </h2>

        <div
          class="theme-transition-all prose prose-zinc max-w-none dark:prose-invert"
        >
          <p
            class="theme-transition-color mb-4 text-base leading-relaxed sm:mb-6 sm:text-lg"
          >
            I build high-performing, adaptive product and engineering
            organizations that deliver exceptional value at high velocity. With
            20+ years across startups, scale-ups, and Fortune 50s, I've learned
            that the conventional wisdom about leadership, teams, and
            organizations is often spectacularly wrong.
          </p>
        </div>
      </div>
    </div>

    <div class="theme-transition-all mx-auto max-w-4xl text-center">
      <h2
        class="theme-transition-color mb-4 text-2xl font-bold text-zinc-900 dark:text-zinc-100 sm:mb-6 sm:text-3xl"
      >
        Get in Touch
      </h2>
      <p
        class="theme-transition-color mb-6 text-base text-zinc-600 dark:text-zinc-400 sm:mb-8 sm:text-lg"
      >
        I'm always open to new opportunities and collaborations. If you'd like
        to work together or just say hello, feel free to reach out.
      </p>

      <a
        href="mailto:ariel@arielperez.io"
        class="theme-transition-all inline-flex items-center justify-center rounded-lg bg-zinc-900 px-6 py-3 text-base font-medium text-zinc-100 transition-colors hover:bg-zinc-700 dark:bg-zinc-100 dark:text-zinc-900 dark:hover:bg-zinc-300 sm:px-8 sm:py-4 sm:text-lg"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="mr-2 h-4 w-4 sm:h-5 sm:w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
          >
          </path>
        </svg>
        Say Hello
      </a>
    </div>
  </div>
</BaseLayout>

<style>
  /* Blob animation */
  .animate-blob {
    animation: blob-bounce 8s infinite ease;
  }

  .animation-delay-2000 {
    animation-delay: 2s;
  }

  /* Tech Stack Slider - Seamless infinite loop */
  .slider-track {
    animation: scroll 40s linear infinite;
    width: fit-content;
  }

  .tech-stack-slider:hover .slider-track {
    animation-play-state: paused;
  }

  .skill-card {
    overflow: hidden;
    position: relative;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  .skill-card:hover {
    z-index: 10;
  }

  .skill-card::before {
    background: radial-gradient(
      circle at center,
      rgb(255 255 255 / 10%) 0%,
      rgb(255 255 255 / 0%) 70%
    );
    content: '';
    height: 120%;
    left: -10%;
    opacity: 0;
    pointer-events: none;
    position: absolute;
    top: -10%;
    transition: opacity 0.5s ease;
    width: 120%;
  }

  .skill-card:hover::before {
    opacity: 1;
  }

  .progress-bar-animate {
    overflow: hidden;
    position: relative;
  }

  .progress-bar-animate::after {
    animation: progress-shine 2s infinite;
    background: linear-gradient(
      90deg,
      transparent,
      rgb(255 255 255 / 20%),
      transparent
    );
    content: '';
    height: 100%;
    left: -100%;
    position: absolute;
    top: 0;
    width: 100%;
  }

  /* Theme transition effect */
  :global(.theme-switching) .theme-transition-element {
    animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* Smooth card transition during theme switch */
  .skill-card.theme-transition-element {
    transition:
      background-color var(--theme-transition),
      border-color var(--theme-transition),
      color var(--theme-transition),
      box-shadow var(--theme-transition),
      transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  @keyframes blob-bounce {
    0%,
    100% {
      transform: translate(0, 0) scale(1);
    }

    25% {
      transform: translate(5%, 5%) scale(1.05);
    }

    50% {
      transform: translate(0, 10%) scale(1);
    }

    75% {
      transform: translate(-5%, 5%) scale(0.95);
    }
  }

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }

    100% {
      transform: translateX(
        calc(-220px * 6 - 16px * 6)
      ); /* Card width + margin for mobile */
    }
  }

  @media (width >= 640px) {
    .slider-track {
      animation: scroll 60s linear infinite;
    }

    @keyframes scroll {
      0% {
        transform: translateX(0);
      }

      100% {
        transform: translateX(
          calc(-280px * 6 - 32px * 6)
        ); /* Card width + margin for desktop */
      }
    }
  }

  /* Reduce animation complexity on mobile for better performance */
  @media (width <= 640px) {
    .skill-card {
      transition:
        transform 0.3s ease,
        box-shadow 0.3s ease;
    }

    .skill-card:hover {
      box-shadow: 0 10px 15px -3px rgb(0 0 0 / 10%) !important;
      transform: translateY(-5px) !important;
    }
  }

  @keyframes progress-shine {
    0% {
      left: -100%;
    }

    100% {
      left: 100%;
    }
  }

  /* Improved touch targets for mobile */
  @media (width <= 640px) {
    a,
    button {
      align-items: center;
      display: flex;
      min-height: 44px;
    }

    .social-link {
      min-height: 44px;
      min-width: 44px;
    }
  }
</style>

<script>
  // Handle SPA transitions for about page
  function setupSPATransitions() {
    // Handle all internal links for SPA transitions
    document.querySelectorAll('a[href^="/"]').forEach((link) => {
      const anchor = link as HTMLAnchorElement
      // Skip links that are anchor links, external links, or already processed
      if (
        anchor.getAttribute('href')?.includes('#') ||
        anchor.getAttribute('target') === '_blank' ||
        anchor.hasAttribute('data-spa-handled')
      ) {
        return
      }

      // Mark as handled to avoid duplicate listeners
      anchor.setAttribute('data-spa-handled', 'true')

      anchor.addEventListener('click', (e) => {
        // Don't handle if modifier keys are pressed (for opening in new tab, etc.)
        if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) {
          return
        }

        e.preventDefault()
        const targetHref = anchor.getAttribute('href')
        if (!targetHref) return

        // Trigger page transition animation
        const pageTransition = document.getElementById('page-transition')
        if (pageTransition) {
          pageTransition.classList.remove('opacity-0')
          pageTransition.classList.add('opacity-100')

          // Navigate after transition effect
          setTimeout(() => {
            window.location.href = targetHref
          }, 300)
        } else {
          // Fallback if transition element doesn't exist
          window.location.href = targetHref
        }
      })
    })

    // Initialize animations for about page
    function animateAboutContent() {
      // Animate hero section elements
      const heroElements = document.querySelectorAll(
        'h1, .order-2 p, .social-links-container'
      )
      heroElements.forEach((el, index) => {
        setTimeout(
          () => {
            el.classList.add('animate-reveal')
          },
          100 + index * 150
        )
      })

      // Animate profile image
      const profileImage = document.querySelector('.aspect-square')
      if (profileImage) {
        setTimeout(() => {
          profileImage.classList.add('animate-reveal')
        }, 200)
      }

      // Animate sections with staggered delay
      const sections = document.querySelectorAll('section')
      sections.forEach((section, index) => {
        setTimeout(
          () => {
            section.classList.add('animate-reveal')
          },
          300 + index * 200
        )
      })
    }

    // Run animations
    animateAboutContent()
  }

  // Initialize on first load
  document.addEventListener('DOMContentLoaded', setupSPATransitions)

  // Re-initialize when content changes via Astro's view transitions
  document.addEventListener('astro:page-load', setupSPATransitions)

  // For compatibility with custom transition system
  document.addEventListener('page-transition-complete', setupSPATransitions)
</script>
